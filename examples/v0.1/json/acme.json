{
  "opendxlApi": "0.1",
  "info": {
    "title": "ACME OpenDXL Solutions",
    "version": "1.2.3",
    "description": "Wily tools for capturing the most elusive threats",
    "contact": {
      "name": "Kai Otee",
      "url": "https://www.opendxl.com/index.php?user/777-kaiotee/",
      "email": "kai_otee@runningroads.com"
    }
  },
  "tags": [
    {
      "name": "drop",
      "description": "Drop-related APIs"
    }
  ],
  "solutions": [
    {
      "name": "ACME Anvil Solution",
      "url": "https://www.opendxl.com/filebase/index.php?file/999-acme-dxl-solution/",
      "services": [
        {
          "name": "ACME Anvil Service",
          "requestTopics": [
            "/opendxl-acme/service/anvil/alertregister",
            "/opendxl-acme/service/anvil/requestdrop",
            "/opendxl-acme/service/anvil/requestdropencrypted"
          ],
          "metadata": {
            "anvilId": "12345",
            "anvilType": "Sheet Metal"
          }
        }
      ],
      "eventTopics": [
        "/opendxl-acme/event/runneralert"
      ]
    }
  ],
  "events": [
    {
      "topic": "/opendxl-acme/event/runneralert",
      "description": "Alerts registered subscribers of a new detected Runner",
      "payload": {
        "properties": {
          "runnerID": {
            "type": "integer"
          },
          "detectTime": {
            "type": "string",
            "format": "date-time"
          }
        },
        "example": {
          "runnerID": 3,
          "detectTime": "2018-10-12T16:39:57-08:00"
        }
      }
    }
  ],
  "requests": [
    {
      "topic": "/opendxl-acme/service/anvil/alertregister",
      "description": "Registers client GUID with ACME Anvil Service for Runner Alert events. Empty payload, does not return a response.",
      "payload": {
        "$ref": "#/definitions/alertRegisterPayload"
      },
      "externalDocs": {
        "url": "https://acmesolutions.com/specs/opendxl/anvil_alert_register"
      }
    },
    {
      "topic": "/opendxl-acme/service/anvil/requestdrop",
      "description": "Requests ACME Anvil Service data drop for the specified target file",
      "tags": [
        "drop"
      ],
      "payload": {
        "$ref": "#/definitions/anvilRequestPayload"
      },
      "response": {
        "payload": {
          "$ref": "#/definitions/anvilResponsePayload"
        }
      },
      "errorResponses": [
        {
          "errorCode": 1,
          "payload": {
            "description": "Unknown target"
          }
        }
      ],
      "externalDocs": {
        "url": "https://acmesolutions.com/specs/opendxl/anvil_request"
      }
    },
    {
      "topic": "/opendxl-acme/service/anvil/requestdropencrypted",
      "description": "Requests an encrypted ACME Anvil Service data drop for the specified target file",
      "payload": {
        "type": "object"
      },
      "tags": [
        "drop"
      ],
      "response": {
        "payload": {
          "description": "Raw encrypted data drop",
          "type": "string",
          "format": "binary"
        },
        "otherFields": [
          {
            "name": "publicKey",
            "description": "Public key for the encrypted data drop"
          }
        ]
      }
    }
  ],
  "definitions": {
    "anvilRequestPayload": {
      "properties": {
        "targetID": {
          "description": "Target ID for file data",
          "type": "string"
        }
      },
      "example": {
        "targetID": "roadRunner.exe"
      }
    },
    "anvilResponsePayload": {
      "properties": {
        "targetID": {
          "description": "Target ID for file data",
          "type": "string"
        },
        "accuracy": {
          "description": "General measure of targeted Anvil data drop accuracy",
          "type": "number",
          "format": "float"
        },
        "velocity": {
          "description": "The velocity of the target",
          "type": "string"
        }
      },
      "example": {
        "targetID": "roadRunner.exe",
        "accuracy": 99.99,
        "velocity": "643 kph"
      }
    },
    "alertRegisterPayload": {
      "properties": {}
    }
  }
}
