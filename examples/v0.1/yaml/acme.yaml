openDxlApi: '0.1'
externalDocs:
  url: https://www.opendxl.com/index.php?user/777-kaiotee/
info:
  title: ACME OpenDXL Solutions
  version: 1.2.3
  description: Wily tools for capturing the most elusive threats
  contact:
    name: Kai Otee
    url: https://www.opendxl.com/index.php?user/777-kaiotee/
    email: kai_otee@runningroads.com
solutions:
  ACME Anvil Solution:
    info:
      title: ACME Anvil Solution
      version: 4.5.6
      description: The ACME Anvil Solution
    externalDocs:
      url: https://www.opendxl.com/filebase/index.php?file/999-acme-dxl-solution/
    services:
    - "$ref": "#/services/ACME Anvil Service"
    events:
    - "$ref": "#/events/~1opendxl-acme~1event~1runneralert"
services:
  ACME Anvil Service:
    info:
      title: ACME Anvil Service
      version: 7.8.9
      description: A service that supports alerts and drops.
    externalDocs:
      url: https://acme.github.io/acme-anvil-service/pydoc/acme-anvil-service.html
    requests:
    - "$ref": "#/requests/~1opendxl-acme~1service~1anvil~1alertregister"
    - "$ref": "#/requests/~1opendxl-acme~1service~1anvil~1requestdrop"
    - "$ref": "#/requests/~1opendxl-acme~1service~1anvil~1requestdropencrypted"
    metadata:
      anvilId:
        description: Id for the anvils that this service manages
        example: '12345'
      anvilType:
        description: Type of anvils that this service manages
        example: Sheet Metal
events:
  "/opendxl-acme/event/runneralert":
    description: Alerts registered subscribers of a new detected Runner
    payload:
      properties:
        runnerID:
          type: integer
        detectTime:
          type: string
          format: date-time
      example:
        runnerID: 3
        detectTime: '2018-10-12T16:39:57-08:00'
requests:
  "/opendxl-acme/service/anvil/alertregister":
    description: Registers client GUID with ACME Anvil Service for Runner Alert events.
      Empty payload, does not return a response.
    payload:
      "$ref": "#/definitions/alertRegisterPayload"
    externalDocs:
      url: https://acmesolutions.com/specs/opendxl/anvil_alert_register
  "/opendxl-acme/service/anvil/requestdrop":
    description: Requests ACME Anvil Service data drop for the specified target file
    payload:
      "$ref": "#/definitions/anvilRequestPayload"
    response:
      payload:
        "$ref": "#/definitions/anvilResponsePayload"
    errorResponses:
      '1':
        description: Unknown target
        payload:
          properties:
            detailedErrorInfo:
              type: string
      '2':
        description: Unexpected error
        payload:
          properties:
            detailedErrorInfo:
              type: string
    externalDocs:
      url: https://acmesolutions.com/specs/opendxl/anvil_request
  "/opendxl-acme/service/anvil/requestdropencrypted":
    description: Requests an encrypted ACME Anvil Service data drop for the specified
      target file
    payload:
      type: object
    response:
      payload:
        description: Raw encrypted data drop
        type: string
        format: binary
      otherFields:
        publicKey:
          description: Public key for the encrypted data drop
          required: true
definitions:
  anvilRequestPayload:
    type: object
    properties:
      targetID:
        description: Target ID for file data
        type: string
    example:
      targetID: roadRunner.exe
  anvilResponsePayload:
    type: object
    properties:
      targetID:
        description: Target ID for file data
        type: string
      accuracy:
        description: General measure of targeted Anvil data drop accuracy
        type: number
        format: float
      velocity:
        description: The velocity of the target
        type: string
    example:
      targetID: roadRunner.exe
      accuracy: 99.99
      velocity: 643 kph
  alertRegisterPayload:
    type: object
    properties: {}
